{% extends "base.html" %}
{% block content %}
<div class="hero" style="padding: 3rem 1.5rem; text-align: left;">
  <div style="max-width: 800px;">
    <h1>Available <span
        style="background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; background-clip: text; color: transparent;">Doctors</span>
    </h1>
    <p>Browse through our certified medical professionals and find the right care for you.</p>

    <div style="margin-top: 2rem; position: relative; max-width: 500px;">
      <input type="text" id="doctorSearch" placeholder="Search by name or specialization..."
        style="width: 100%; padding: 1rem 1.5rem; border-radius: 16px; border: 1px solid var(--card-border); background: var(--glass); color: white; backdrop-filter: blur(8px);">
      <span style="position: absolute; right: 1.5rem; top: 1.1rem; opacity: 0.5;">üîç</span>
    </div>
  </div>
</div>

<div class="grid" id="doctorGrid">
  {% for d in doctors %}
  <div class="card doctor-card" data-name="{{ d.name|lower }}" data-spec="{{ d.specialization|lower }}">
    <div style="display: flex; gap: 1.5rem; align-items: center; margin-bottom: 1.5rem;">
      <div
        style="width: 64px; height: 64px; border-radius: 16px; background: linear-gradient(135deg, var(--primary), var(--secondary)); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; overflow: hidden; color: white;">
        {{ d.name[4] if d.name.startswith('Dr. ') else d.name[0] }}
      </div>
      <div>
        <h3 style="margin: 0;">{{ d.name }}</h3>
        <span class="badge"
          style="background: rgba(99, 102, 241, 0.1); color: var(--primary); border: none; font-size: 0.75rem;">
          {{ d.specialization }}
        </span>
      </div>
    </div>

    <div style="display: flex; flex-direction: column; gap: 0.75rem; margin-bottom: 1.5rem;">
      <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--muted); font-size: 0.875rem;">
        <span>üìÖ</span> {{ d.available_days }}
      </div>
      <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--muted); font-size: 0.875rem;">
        <span>üïí</span> {{ d.time_slots }}
      </div>
    </div>

    {% if booked_counts and (d.id|string in booked_counts or d.id in booked_counts) %}
    <div
      style="padding: 0.75rem; border-radius: 12px; background: rgba(239, 68, 68, 0.1); color: var(--danger); font-size: 0.8125rem; margin-bottom: 1rem; border: 1px solid rgba(239, 68, 68, 0.2);">
      ‚ö†Ô∏è Busy: {{ booked_counts[d.id] }} slots booked today
    </div>
    {% endif %}

    <a class="btn btn-primary" href="/book/{{ d.id }}" style="width: 100%;">Book Appointment</a>
  </div>
  {% else %}
  <div class="card col-12" style="text-align: center; padding: 4rem;">
    <h3>No doctors found</h3>
    <p>Try searching for a different name or specialty.</p>
  </div>
  {% endfor %}
</div>

<script>
  document.getElementById('doctorSearch').addEventListener('input', function (e) {
    const term = e.target.value.toLowerCase();
    const cards = document.querySelectorAll('.doctor-card');

    cards.forEach(card => {
      const name = card.getAttribute('data-name');
      const spec = card.getAttribute('data-spec');
      if (name.includes(term) || spec.includes(term)) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
  });
</script>

{% endblock %}