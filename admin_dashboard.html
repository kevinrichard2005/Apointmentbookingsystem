{% extends "base.html" %}
{% block content %}

<div class="hero" style="padding: 3rem 2rem; text-align: left;">
  <div
    style="max-width: 800px; display: flex; justify-content: space-between; align-items: center; width: 100%; flex-wrap: wrap; gap: 1.5rem;">
    <div>
      <h1>Admin Control <span
          style="background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; background-clip: text; color: transparent;">Center</span>
      </h1>
      <p>System overview and appointment management.</p>
    </div>
    <a class="btn btn-primary" href="/admin/add-doctor" style="padding: 1rem 1.5rem; font-size: 1rem;">+ Add New
      Physician</a>
  </div>
</div>

<div class="stats-row">
  <div class="stat-item">
    <div class="label">Total Healthcare Users</div>
    <div class="value">{{ users_count }}</div>
    <div class="trend up"><span>â†‘</span> Registered patients</div>
  </div>
  <div class="stat-item">
    <div class="label">Verified Doctors</div>
    <div class="value">{{ doctors_count }}</div>
    <div class="trend" style="color: var(--secondary);"><span>ðŸ©º</span> Professional staff</div>
  </div>
  <div class="stat-item">
    <div class="label">Total Appointments</div>
    <div class="value">{{ appointments_count }}</div>
    <div class="trend up"><span>ðŸ“Š</span> Processed bookings</div>
  </div>
</div>

<div class="table-container">
  <table class="table">
    <thead>
      <tr>
        <th>Patient Name</th>
        <th>Physician</th>
        <th>Schedule</th>
        <th>Status</th>
        <th>Quick Management</th>
      </tr>
    </thead>
    <tbody>
      {% for a in appointments %}
      <tr>
        <td>
          <div style="font-weight: 600;">{{ a.user_name }}</div>
          <div style="font-size: 0.75rem; color: var(--muted);">ID: #{{ a.user_id }}</div>
        </td>
        <td>
          <div style="display: flex; align-items: center; gap: 0.75rem;">
            <div
              style="width: 28px; height: 28px; border-radius: 6px; background: rgba(99, 102, 241, 0.1); color: var(--primary); display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.7rem;">
              {{ a.doctor_name[4] if a.doctor_name.startswith('Dr. ') else a.doctor_name[0] }}
            </div>
            <span>{{ a.doctor_name }}</span>
          </div>
        </td>
        <td>
          <div style="font-weight: 500;">{{ a.date }}</div>
          <div style="font-size: 0.8rem; color: var(--muted);">{{ a.time }}</div>
        </td>
        <td>
          <span class="badge 
            {% if a.status == 'Approved' or a.status == 'Completed' %}success{% endif %}
            {% if a.status == 'Cancelled' %}danger{% endif %}
            {% if a.status == 'Pending' %}warn{% endif %}
          ">
            {{ a.status }}
          </span>
        </td>
        <td>
          <form method="POST" action="/admin/update-status/{{ a.id }}" style="display:flex; gap:8px;">
            <select name="status" class="btn" style="padding: 6px 10px; font-size: 0.8rem; background: var(--bg);">
              <option value="Pending" {% if a.status=='Pending' %}selected{% endif %}>Pending</option>
              <option value="Approved" {% if a.status=='Approved' %}selected{% endif %}>Approved</option>
              <option value="Completed" {% if a.status=='Completed' %}selected{% endif %}>Completed</option>
              <option value="Cancelled" {% if a.status=='Cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
            <button class="btn btn-primary" type="submit" style="padding: 6px 12px; font-size: 0.8rem;">Update</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="5" style="text-align: center; padding: 4rem; color: var(--muted);">
          No appointments recorded in the system.
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}